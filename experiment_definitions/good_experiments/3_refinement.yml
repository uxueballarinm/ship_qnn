# # -----------------------------------------------------------------------------
# # HYPERPARAMETER SWEEP: Topology and Depth
# # -----------------------------------------------------------------------------

# # SWEEP 1: Leaner Dynamics (Reps=2)
# # Hypothesis: 3 reps (100+ params) is too hard to optimize. 2 reps might train better.
# - window_size: 5
#   data: reduce_dataset_cobyla
#   select_features: ['wv', 'sv', 'yr', 'ya', 'rarad']
#   model: multihead
#   predict: motion
#   optimizer: cobyla
#   maxiter: 4000
#   initialization: identity
#   reorder: false
#   run: [0, 1, 2]

#   heads_config:
#     - features: ['wv', 'sv', 'rarad']
#       output_dim: 1
#       reps: 3
#       encoding: compact
#       ansatz: efficientsu2
#       entangle: full
#       map: [0, 1, 2]
#     - features: ['sv', 'yr', 'rarad'] # Head 2
#       output_dim: 2
#       reps: 2             # <--- CHANGE: Reduced Depth
#       encoding: compact
#       ansatz: efficientsu2
#       entangle: full
#       map: [0, 1, 2]
#     - features: ['ya', 'yr']
#       output_dim: 1
#       reps: 1
#       encoding: compact
#       ansatz: realamplitudes
#       entangle: full
#       map: [0, 1, -1]

# SWEEP 2: Circular Entanglement
# Hypothesis: "Circular" topology matches the cyclic nature of Yaw/Sway physics better.
- window_size: 5
  data: reduce_dataset_cobyla
  select_features: ['wv', 'sv', 'yr', 'ya', 'rarad']
  model: multihead
  predict: motion
  optimizer: cobyla
  maxiter: 4000
  initialization: identity
  reorder: false
  run: [1, 2]

  heads_config:
    - features: ['wv', 'sv', 'rarad']
      output_dim: 1
      reps: 3
      encoding: compact
      ansatz: efficientsu2
      entangle: circular  # <--- CHANGE
      map: [0, 1, 2]
    - features: ['sv', 'yr', 'rarad']
      output_dim: 2
      reps: 3
      encoding: compact
      ansatz: efficientsu2
      entangle: circular  # <--- CHANGE
      map: [0, 1, 2]
    - features: ['ya', 'yr']
      output_dim: 1
      reps: 1
      encoding: compact
      ansatz: realamplitudes
      entangle: circular  # <--- CHANGE
      map: [0, 1, -1]